<?php
// config.php.example
// -----------------------------------------------------------------
//  步骤 1: 将此文件重命名为 'config.php'
// -----------------------------------------------------------------
// 
//  重命名后，您需要设置下面的加密密钥。

// -----------------------------------------------------------------
//  步骤 2: 设置您的加密密钥 (!! 必须修改 !!)
// -----------------------------------------------------------------
//
// 这是一个用于加密数据库中所有消息的密钥。
// 它必须是一个 64 个字符长的安全字符串。
//
// 如何生成密钥:
// 如果您有权访问服务器的命令行 (SSH)，请运行此命令:
//
//   php -r 'echo bin2hex(random_bytes(32));'
//
// 这将输出一个 64 个字符的密钥。将其复制并粘贴到下面。
//
// 如果您没有命令行访问权限 (例如，在共享主机上)，
// 您可以使用在线生成器，或在本地计算机上运行上述命令 (如果您安装了 PHP)。
//
// !! 警告: 这是一个不安全的占位符，应用将无法工作，直到您替换它 !!
//
$encrypt_key = '!!INSECURE_REPLACE_THIS_WITH_YOUR_OWN_64_CHAR_HEX_KEY!!';


// -----------------------------------------------------------------
//  步骤 3: (可选) 应用配置 (通常不需要修改)
// -----------------------------------------------------------------
$CONFIG = [
    // 数据库文件路径 (必须确保此目录可写)
    // 默认值: __DIR__ . '/messages.db' (表示在当前文件夹下)
    'db_path'        => __DIR__ . '/messages.db',
    
    // 消息最大字符数
    'max_size'       => 10000,
    
    // 自动清理过期消息的几率 (1-100)
    // 20 表示有 20% 的几率在用户查看消息时触发清理
    'cleanup_chance' => 20,
    
    // 加密密钥 (!! 确保这里引用的是您在上面设置的变量 !!)
    'encrypt_key'    => $encrypt_key
];

// -----------------------------------------------------------------
// (安全检查) 确保密钥已被修改
// -----------------------------------------------------------------
if (strpos($CONFIG['encrypt_key'], '!!INSECURE') === 0 || strlen($CONFIG['encrypt_key']) < 64) {
    // 在日志中记录严重错误，并对用户显示通用错误
    error_log('FATAL ERROR: ENCRYPT_KEY is not set or is insecure. Please update config.php.');
    // 阻止应用运行
    die('服务器配置错误：加密密钥 (ENCRYPT_KEY) 未在 config.php 中正确设置。请检查文件并确保密钥已更新且长度足够。');
}